// Generated by CoffeeScript 1.9.3
(function() {
  "use strict";
  var Ivoire, _;

  Ivoire = require('ivoire');

  _ = require('lodash');

  Ivoire.prototype.weighted_choice = function(items, weights) {
    var i, j, len, option, random, rolling_total, weight_sum;
    this.panic_if(items.length !== weights.length, "Items and weights must be the same length");
    this.panic_if(items.length < 1, "Must provide at least one option");
    weight_sum = _.reduce(weights, (function(sum, weight) {
      return weight + sum;
    }), 0);
    this.panic_if(weight_sum < 0, "Weights must sum to zero or above (got " + (JSON.stringify(weights)) + ")");
    random = this.random();
    rolling_total = 0;
    for (i = j = 0, len = items.length; j < len; i = ++j) {
      option = items[i];
      rolling_total += weights[i] / weight_sum;
      if (rolling_total >= random) {
        return items[i];
      }
    }
    throw new Error("weightedChoice() returned nothing");
  };

  module.exports = Ivoire;

}).call(this);
